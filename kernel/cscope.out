cscope 15 $HOME/mylinux/kernel               0000058010
	@clock.c

1 
	~"h—d.h
"

2 
	$şock_hªdËr
(
œq
)

4 
ticks
++;

5 
p_´oc_»ady
->
ticks
--;

6 if(
k_»’‹r
!=0)

10 
	`scheduË
();

11 
	}
}

13 
	$mli_d–ay
(
mli_£c
)

15 
t
=
	`g‘_ticks
();

16 ((
	`g‘_ticks
()-
t
è*1000 /
HZ
è< 
mli_£c
){}

17 
	}
}

19 
	$š™_şock
()

22 
	`out_by‹
(
TIMER_MODE_REG
,
RATE_GENERATOR
);

23 
	`out_by‹
(
TIMER0_REG
,(
u8
è(
TIMER_FREG
/
HZ
));

24 
	`out_by‹
(
TIMER0_REG
,(
u8
)((
TIMER_FREG
/
HZ
)>>8));

26 
	`put_œq_hªdËr
(
CLOCK_IRQ
,
şock_hªdËr
);

27 
	`’abË_œq
(
CLOCK_IRQ
);

28 
	}
}

	@console.c

1 
	~"h—d.h
"

2 
	~"keybßrd.h
"

4 
£t_cursÜ
(
u32
 
pos™iÚ
);

5 
£t_video_¡¬t_addr
(
u32
 
addr
);

6 
æush
(
CONSOLE
* 
p_cÚ
);

8 
	$süŞl_sü“n
(
CONSOLE
* 
p_cÚ
,
dœeùiÚ
)

10 if(
dœeùiÚ
 =ğ
SCR_UP
)

12 if((()(
p_cÚ
->
cu¼’t_¡¬t_addr
)-
SCREEN_WIDTH
è> ()Õ_cÚ->
Üigš®_addr
))

13 
p_cÚ
->
cu¼’t_¡¬t_addr
-=
SCREEN_WIDTH
;

15 if(
dœeùiÚ
 =ğ
SCR_DN
)

17 if(
p_cÚ
->
cu¼’t_¡¬t_addr
+
SCREEN_SIZE
 <…_cÚ->
Üigš®_addr
+p_cÚ->
v_mem_lim™
)

18 
p_cÚ
->
cu¼’t_¡¬t_addr
+=
SCREEN_WIDTH
;

22 
	`£t_video_¡¬t_addr
(
p_cÚ
->
cu¼’t_¡¬t_addr
);

23 
	`£t_cursÜ
(
p_cÚ
->
cursÜ
);

24 
	}
}

26 
	$is_cu¼’t_cÚsŞe
(
CONSOLE
* 
p_cÚ
)

28  (
p_cÚ
 =ğ
cÚsŞe_bË
+ 
Ä_cu¼’t_cÚsŞe
);

29 
	}
}

31 
	$out_ch¬
(
CONSOLE
* 
p_cÚ
,
ch
)

33 
u8
* 
p_vmem
=(u8*)(
V_MEM_BASE
 +
p_cÚ
->
cursÜ
*2);

34 
ch
)

37 if(
p_cÚ
->
cursÜ
 <…_cÚ->
Üigš®_addr
+p_cÚ->
v_mem_lim™
-
SCREEN_WIDTH
)

39 
p_cÚ
->
cursÜ
õ_cÚ->
Üigš®_addr
+
SCREEN_WIDTH
*((p_con->cursor-p_con->original_addr)/SCREEN_WIDTH +1);

43 if(
p_cÚ
->
cursÜ
>…_cÚ->
Üigš®_addr
)

45 
p_cÚ
->
cursÜ
--;

46 *(
p_vmem
-2)=' ';

47 *(
p_vmem
-1)=
DEFAULT_CHAR_COLOR
;

51 if(
p_cÚ
->
cursÜ
 <…_cÚ->
Üigš®_addr
+p_cÚ->
v_mem_lim™
 -1)

53 *
p_vmem
++=
ch
;

54 *
p_vmem
++=
DEFAULT_CHAR_COLOR
;

55 
p_cÚ
->
cursÜ
++;

58 
p_cÚ
->
cursÜ
>õ_cÚ->
cu¼’t_¡¬t_addr
+
SCREEN_SIZE
)

60 
	`süŞl_sü“n
(
p_cÚ
,
SCR_DN
);

62 if(
	`is_cu¼’t_cÚsŞe
(
p_cÚ
))

63 
	`æush
(
p_cÚ
);

64 
	}
}

66 
	$æush
(
CONSOLE
* 
p_cÚ
)

68 
	`£t_cursÜ
(
p_cÚ
->
cursÜ
);

69 
	`£t_video_¡¬t_addr
(
p_cÚ
->
cu¼’t_¡¬t_addr
);

70 
	}
}

73 
	$£t_cursÜ
(
u32
 
pos™iÚ
)

75 
	`di§bË_št
();

76 
	`out_by‹
(
CRTC_ADDR_REG
,
CURSOR_H
);

77 
	`out_by‹
(
CRTC_DATA_REG
,(
pos™iÚ
>>8)&0xff);

78 
	`out_by‹
(
CRTC_ADDR_REG
,
CURSOR_L
);

79 
	`out_by‹
(
CRTC_DATA_REG
,
pos™iÚ
 & 0xff);

80 
	`’abË_št
();

81 
	}
}

84 
	$š™_sü“n
(
TTY
* 
p_‰y
)

86 
Ä_‰y
=
p_‰y
-
‰y_bË
;

87 
p_‰y
->
p_cÚsŞe
=
cÚsŞe_bË
+
Ä_‰y
;

88 
v_mem_size
=
V_MEM_SIZE
>>1;

89 
cÚ_v_mem_size
=
v_mem_size
/
NR_CONSOLES
;

90 
p_‰y
->
p_cÚsŞe
->
Üigš®_addr
=
Ä_‰y
*
cÚ_v_mem_size
;

91 
p_‰y
->
p_cÚsŞe
->
v_mem_lim™
=
cÚ_v_mem_size
;

92 
p_‰y
->
p_cÚsŞe
->
cu¼’t_¡¬t_addr
õ_‰y->p_cÚsŞe->
Üigš®_addr
;

93 
p_‰y
->
p_cÚsŞe
->
cursÜ
õ_‰y->p_cÚsŞe->
Üigš®_addr
;

94 if(
Ä_‰y
 ==0)

96 
p_‰y
->
p_cÚsŞe
->
cursÜ
=
di¥_pos
/2;

97 
di¥_pos
=0;

101 
	`out_ch¬
(
p_‰y
->
p_cÚsŞe
,
Ä_‰y
+'0');

102 
	`out_ch¬
(
p_‰y
->
p_cÚsŞe
,'#');

105 
	`£t_cursÜ
(
p_‰y
->
p_cÚsŞe
->
cursÜ
);

106 
	}
}

108 
	$£Ëù_cÚsŞe
(
Ä_cÚsŞe
)

110 if((
Ä_cÚsŞe
<0è||Òr_cÚsŞe>=
NR_CONSOLES
))

114 
Ä_cu¼’t_cÚsŞe
=
Ä_cÚsŞe
;

115 
	`£t_cursÜ
(
cÚsŞe_bË
[
Ä_cu¼’t_cÚsŞe
].
cursÜ
);

116 
	`£t_video_¡¬t_addr
(
cÚsŞe_bË
[
Ä_cu¼’t_cÚsŞe
].
cu¼’t_¡¬t_addr
);

117 
	}
}

120 
	$£t_video_¡¬t_addr
(
u32
 
addr
)

122 
	`di§bË_št
();

123 
	`out_by‹
(
CRTC_ADDR_REG
,
START_ADDR_H
);

124 
	`out_by‹
(
CRTC_DATA_REG
,(
addr
>>8)&0xff);

125 
	`out_by‹
(
CRTC_ADDR_REG
,
START_ADDR_L
);

126 
	`out_by‹
(
CRTC_DATA_REG
,
addr
&0xff);

127 
	`’abË_št
();

128 
	}
}

	@global.c

1 
	#GLOBAL_VARIABLES_HERE


	)

3 
	~"h—d.h
"

4 
PROCESS
 
	g´oc_bË
[
NR_TASKS
+ 
NR_PROCS
];

6 
TASK
 
	gsk_bË
[
NR_TASKS
]=

8 {
sk_‰y
,
STACK_SIZE_TTY
,"TTY"},

9 {
sk_sys
,
STACK_SIZE_SYS
,"SYS"}

11 
TASK
 
	gu£r_´oc_bË
[
NR_PROCS
]=

13 {
Te¡A
,
STACK_SIZE_TESTA
,"TestA"},

14 {
Te¡B
,
STACK_SIZE_TESTB
,"TestB"},

15 {
Te¡C
,
STACK_SIZE_TESTC
,"TestC"}

17 
	gsk_¡ack
[
STACK_SIZE_TOTAL
];

18 
TTY
 
	g‰y_bË
[
NR_CONSOLES
];

19 
CONSOLE
 
	gcÚsŞe_bË
[
NR_CONSOLES
];

20 
œq_hªdËr
 
	gœq_bË
[
NR_IRQ
];

21 
sy¡em_ÿÎ
 
	gsys_ÿÎ_bË
[
NR_SYS_CALL
]={
sys_´štx
,

22 
sys_£nd»c
};

	@i8259.c

1 
	~"h—d.h
"

3 
	$š™_8259A
()

5 
	`out_by‹
(
INT_M_CTL
,0x11);

7 
	`out_by‹
(
INT_S_CTL
,0x11);

9 
	`out_by‹
(
INT_M_CTLMASK
,
INT_VECTOR_IRQ0
);

11 
	`out_by‹
(
INT_S_CTLMASK
,
INT_VECTOR_IRQ8
);

13 
	`out_by‹
(
INT_M_CTLMASK
,0x4);

15 
	`out_by‹
(
INT_S_CTLMASK
,0x2);

17 
	`out_by‹
(
INT_M_CTLMASK
,0X1);

19 
	`out_by‹
(
INT_S_CTLMASK
,0x1);

21 
	`out_by‹
(
INT_M_CTLMASK
,0xff);

23 
	`out_by‹
(
INT_S_CTLMASK
,0xff);

25 
i
;

26 
i
=0;i<
NR_IRQ
;i++)

28 
œq_bË
[
i
]=
¥urious_œq
;

30 
	}
}

33 
	$¥urious_œq
(
œq
)

35 
	`di¥_¡r
("spurious_irq: ");

36 
	`di¥_št
(
œq
);

37 
	`di¥_¡r
("\n");

38 
	}
}

40 
	$put_œq_hªdËr
(
œq
,
œq_hªdËr
 
hªdËr
)

42 
	`di§bË_œq
(
œq
);

43 
œq_bË
[
œq
]=
hªdËr
;

44 
	}
}

	@kernel.S

2 .
gdt_±r
,
idt_±r
,
p_´oc_»ady
,
tss
,
di¥_pos
,
k_»’‹r


4 .
c¡¬t
,
k”Ãl_maš
,
exû±iÚ_hªdËr
,
¥urious_œq
,
şock_hªdËr
,
sys_ÿÎ_bË


7 .
bss


8 
SckS·û
: .
fl
 2048

9 
SckTİ
:

11 .
‹xt


13 
	~"scÚ¡.h
"

14 .
glob®
 
_¡¬t
 ,
»¡¬t
,
sys_ÿÎ


16 .
glob®
 
divide_”rÜ
,
sšgË_¡•_exû±iÚ
,
nmi
,
b»akpošt_exû±iÚ


17 .
glob®
 
ov”æow
,
bounds_check
,
šv®_İcode
,
cİr_nÙ_avaabË


18 .
glob®
 
doubË_çuÉ
,
cİr_£g_ov”run
,
šv®_tss
,
£gm’t_nÙ_´e£Á


19 .
glob®
 
¡ack_exû±iÚ
,
g’”®_´ÙeùiÚ
,
·ge_çuÉ
,
cİr_”rÜ


20 .
glob®
 
hwšt00


21 .
glob®
 
hwšt01


22 .
glob®
 
hwšt02


23 .
glob®
 
hwšt03


24 .
glob®
 
hwšt04


25 .
glob®
 
hwšt05


26 .
glob®
 
hwšt06


27 .
glob®
 
hwšt07


28 .
glob®
 
hwšt08


29 .
glob®
 
hwšt09


30 .
glob®
 
hwšt10


31 .
glob®
 
hwšt11


32 .
glob®
 
hwšt12


33 .
glob®
 
hwšt13


34 .
glob®
 
hwšt14


35 .
glob®
 
hwšt15


38 
_¡¬t
:

39 
mov
 
$SckTİ
,%
e¥


40 
movl
 
$0
,(
di¥_pos
)

41 
	$sgdt
 (
gdt_±r
)

42 
ÿÎ
 
c¡¬t


43 
	$lgdt
 (
gdt_±r
)

44 
	$lidt
 (
idt_±r
)

46 
jmp
 
$SELECTOR_KERNEL_CS
,
$csš™


47 
csš™
:

48 
movb
 
$0x0f
,%
ah


49 
movb
 
$
'K',%
®


50 
mov
 %
ax
,%
gs
:((80*1+39)*2)

51 
xÜ
 %
—x
,%eax

52 
mov
 
$SELECTOR_TSS
,%
ax


53 
Ér
 %
ax


54 
jmp
 
k”Ãl_maš


56 .
maüo
 
hwšt_ma¡”
 
n


57 
ÿÎ
 
§ve


58 
š
 
$0x21
,%
®


59 
Ü
 
	`$
(1<<\
n
),%
®


60 
out
 %
®
,
$0x21


62 
mov
 
$EOI
,%
®


63 
out
 %
®
,
$0x20


64 
¡i


66 
push
 
	`$
(\
n
)

67 
mov
 
$œq_bË
,%
ebx


68 
ÿÎ
 *(4*\
n
)(%
ebx
)

69 
add
 
$4
,%
e¥


70 
şi


72 
š
 
$0x21
,%
®


73 
ªd
 
$
~(1<<\
n
),%
®


74 
out
 %
®
,
$0x21


76 
»t


77 .
’dm


79 .
®ign
 16

80 
sys_ÿÎ
:

81 
ÿÎ
 
§ve


82 
	$pushl
 (
p_´oc_»ady
)

83 
¡i


84 
push
 %
esi


85 
push
 %
edx


86 
push
 %
ecx


87 
push
 %
ebx


88 
ÿÎ
 *
	`sys_ÿÎ_bË
(,%
—x
,4)

89 
add
 
$16
,%
e¥


90 
pİ
 %
esi


91 
mov
 %
—x
,(
EAXREG
-
P_STACKBASE
)(%
esi
)

92 
şi


93 
»t


95 
hwšt00
:

96 
hwšt_ma¡”
 0

97 
§ve
:

98 
push®


99 
push
 %
ds


100 
push
 %
es


101 
push
 %
fs


102 
push
 %
gs


103 
mov
 %
edx
,%
esi


104 
mov
 %
ss
,%
dx


105 
mov
 %
dx
,%
ds


106 
mov
 %
dx
,%
es


107 
mov
 %
esi
,%
edx


109 
mov
 %
e¥
,%
esi


111 
	$šş
 (
k_»’‹r
)

112 
cm¶
 
$0
,(
k_»’‹r
)

113 
jÃ
 .
»_’‹r1


115 
mov
 
$SckTİ
,%
e¥


116 
push
 
$»¡¬t


117 
jmp
 *(
RETADR
-
P_STACKBASE
)(%
esi
)

118 .
»_’‹r1
:

119 
push
 
$»¡¬t_»’‹r


120 
jmp
 *(
RETADR
-
P_STACKBASE
)(%
esi
)

123 .
®ign
 16

124 
hwšt01
: #IÁ”ru± 
routše
 
œq
 1 (
keybßrd
)

125 
hwšt_ma¡”
 1

127 .
®ign
 16

128 
hwšt02
: #IÁ”ru± 
routše
 
œq
 2 (
ÿsÿde
!)

129 
hwšt_ma¡”
 2

131 .
®ign
 16

132 
hwšt03
: #IÁ”ru± 
routše
 
œq
 3 (
£cÚd
 
£rŸl
)

133 
hwšt_ma¡”
 3

135 .
®ign
 16

136 
hwšt04
: #IÁ”ru± 
routše
 
œq
 4 (
fœ¡
 
£rŸl
)

137 
hwšt_ma¡”
 4

139 .
®ign
 16

140 
hwšt05
: #IÁ”ru± 
routše
 
œq
 5 (
XT
 
wšche¡”
)

141 
hwšt_ma¡”
 5

143 .
®ign
 16

144 
hwšt06
: #IÁ”ru± 
routše
 
œq
 6 (
æİpy
)

145 
hwšt_ma¡”
 6

147 .
®ign
 16

148 
hwšt07
: #IÁ”ru± 
routše
 
œq
 7 (
´š‹r
)

149 
hwšt_ma¡”
 7

151 .
maüo
 
hwšt_¦ave
 
n


152 
push
 
	`$
(\
n
)

153 
ÿÎ
 
¥urious_œq


154 
add
 
$4
,%
e¥


155 
œ‘


156 .
’dm


158 .
®ign
 16

159 
hwšt08
: #IÁ”ru± 
routše
 
œq
 8 (
»®time
 
şock
).

160 
hwšt_¦ave
 8

162 .
®ign
 16

163 
hwšt09
: #IÁ”ru± 
routše
 
œq
 9 (œq 2 
»dœeùed
)

164 
hwšt_¦ave
 9

166 .
®ign
 16

167 
hwšt10
: #IÁ”ru± 
routše
 
œq
 10

168 
hwšt_¦ave
 10

170 .
®ign
 16

171 
hwšt11
: #IÁ”ru± 
routše
 
œq
 11

172 
hwšt_¦ave
 11

174 .
®ign
 16

175 
hwšt12
: #IÁ”ru± 
routše
 
œq
 12

176 
hwšt_¦ave
 12

178 .
®ign
 16

179 
hwšt13
: #IÁ”ru± 
routše
 
œq
 13 (
FPU
 
exû±iÚ
)

180 
hwšt_¦ave
 13

182 .
®ign
 16

183 
hwšt14
: #IÁ”ru± 
routše
 
œq
 14 (
AT
 
wšche¡”
)

184 
hwšt_¦ave
 14

186 .
®ign
 16

187 
hwšt15
: #IÁ”ru± 
routše
 
œq
 15

188 
hwšt_¦ave
 15

190 
divide_”rÜ
:

191 
push
 
$0xffffffff


192 
push
 
$0


193 
jmp
 
exû±iÚ


194 
sšgË_¡•_exû±iÚ
:

195 
push
 
$0xffffffff


196 
push
 
$1


197 
jmp
 
exû±iÚ


198 
nmi
:

199 
push
 
$0xffffffff


200 
push
 
$2


201 
jmp
 
exû±iÚ


202 
b»akpošt_exû±iÚ
:

203 
push
 
$0xffffffff


204 
push
 
$3


205 
jmp
 
exû±iÚ


206 
ov”æow
:

207 
push
 
$0xffffffff


208 
push
 
$4


209 
jmp
 
exû±iÚ


210 
bounds_check
:

211 
push
 
$0xffffffff


212 
push
 
$5


213 
jmp
 
exû±iÚ


214 
šv®_İcode
:

215 
push
 
$0xffffffff


216 
push
 
$6


217 
jmp
 
exû±iÚ


218 
cİr_nÙ_avaabË
:

219 
push
 
$0xffffffff


220 
push
 
$7


221 
jmp
 
exû±iÚ


222 
doubË_çuÉ
:

223 
push
 
$8


224 
jmp
 
exû±iÚ


225 
cİr_£g_ov”run
:

226 
push
 
$0xffffffff


227 
push
 
$9


228 
jmp
 
exû±iÚ


229 
šv®_tss
:

230 
push
 
$10


231 
jmp
 
exû±iÚ


232 
£gm’t_nÙ_´e£Á
:

233 
push
 
$11


234 
jmp
 
exû±iÚ


235 
¡ack_exû±iÚ
:

236 
push
 
$12


237 
jmp
 
exû±iÚ


238 
g’”®_´ÙeùiÚ
:

239 
push
 
$13


240 
jmp
 
exû±iÚ


241 
·ge_çuÉ
:

242 
push
 
$14


243 
jmp
 
exû±iÚ


244 
cİr_”rÜ
:

245 
push
 0xffffffff

246 
push
 
$16


247 
jmp
 
exû±iÚ


249 
exû±iÚ
:

250 
ÿÎ
 
exû±iÚ_hªdËr


251 
add
 
$8
,%
e¥


252 
jmp
 .

254 
»¡¬t
:

255 
	`mov
 (
p_´oc_»ady
),%
e¥


256 
	`Îdt
 (
P_LDT_SEL
)(%
e¥
)

257 
	`Ëa
 (
P_STACKTOP
)(%
e¥
),%
—x


258 
mov
 
$tss
,%
ebx


259 
mov
 %
—x
,(
TSS3_S_SP0
)(%
ebx
)

261 
»¡¬t_»’‹r
:

262 
	$deş
 (
k_»’‹r
)

263 
pİ
 %
gs


264 
pİ
 %
fs


265 
pİ
 %
es


266 
pİ
 %
ds


267 
pİ®


269 
add
 
$4
,%
e¥


271 
œ‘


	@keyboard.c

1 
	~"h—d.h
"

2 
	~"keybßrd.h
"

3 
	~"keym­.h
"

5 
KB_INPUT
 
	gkb_š
;

6 
	gcode_w™h_E0
=0;

7 
	gshiá_l
;

8 
	gshiá_r
;

9 
	g®t_l
;

10 
	g®t_r
;

11 
	gù¾_l
;

12 
	gù¾_r
;

13 
	gÿps_lock
;

14 
	gnum_lock
;

15 
	gsüŞl_lock
;

16 
	gcŞumn
;

18 
u8
 
g‘_by‹_äom_kbuf
();

19 
kb_wa™
();

20 
kb_ack
();

21 
£t_Ëds
();

23 
	$keybßrd_hªdËr
(
œq
)

25 
u8
 
sÿn_code
=
	`š_by‹
(0x60);

27 if(
kb_š
.
couÁ
< 
KB_IN_BYTES
)

29 *(
kb_š
.
p_h—d
++)=
sÿn_code
;

30 if(
kb_š
.
p_h—d
 =ğkb_š.
buf
+
KB_IN_BYTES
)

32 
kb_š
.
p_h—d
=kb_š.
buf
;

34 
kb_š
.
couÁ
++;

36 
	}
}

38 
	$š™_keybßrd
()

40 
kb_š
.
couÁ
=0;

41 
kb_š
.
p_h—d
=kb_š.
p_
=kb_š.
buf
;

42 
shiá_l
=
shiá_r
=0;

43 
®t_l
=
®t_r
=0;

44 
ù¾_l
=
ù¾_r
=0;

45 
ÿps_lock
=1;

46 
num_lock
=1;

47 
süŞl_lock
=0;

48 
	`£t_Ëds
();

49 
	`put_œq_hªdËr
(
KEYBOARD_IRQ
,
keybßrd_hªdËr
);

50 
	`’abË_œq
(
KEYBOARD_IRQ
);

51 
	}
}

53 
	$keybßrd_»ad
(
TTY
* 
p_‰y
)

55 
u8
 
sÿn_code
;

56 
make
;

57 
u32
 
key
=0;

58 
u32
* 
keyrow
=0;

60 if(
kb_š
.
couÁ
 > 0)

62 
code_w™h_E0
=0;

63 
	`di§bË_št
();

64 
sÿn_code
=
	`g‘_by‹_äom_kbuf
();

66 if(
sÿn_code
 == 0xe1)

68 
i
;

69 
u8
 
·u£b»ak_scode
[]={0xE1,0x1D,0x45,0xE1,0x9d,0xc5};

70 
is_·u£b»ak
=1;

71 
i
=1;i<6;i++)

73 if(
	`g‘_by‹_äom_kbuf
()!=
·u£b»ak_scode
[
i
])

75 
is_·u£b»ak
=0;

79 if(
is_·u£b»ak
)

81 
key
=
PAUSEBREAK
;

84 if(
sÿn_code
 == 0xe0)

86 
sÿn_code
=
	`g‘_by‹_äom_kbuf
();

87 if(
sÿn_code
== 0x2a)

88 if(
	`g‘_by‹_äom_kbuf
() == 0xe0)

89 if(
	`g‘_by‹_äom_kbuf
() == 0x37)

91 
key
=
PRINTSCREEN
;

92 
make
=1;

94 if(
sÿn_code
 == 0xb7)

95 if(
	`g‘_by‹_äom_kbuf
() == 0xe0)

96 if(
	`g‘_by‹_äom_kbuf
() == 0xaa)

98 
key
=
PRINTSCREEN
;

99 
make
=0;

101 if(
key
==0)

102 
code_w™h_E0
=1;

104 if((
key
 !ğ
PAUSEBREAK
è&& (key !ğ
PRINTSCREEN
))

106 
make
=(
sÿn_code
 & 
FLAG_BREAK
 ? 
FALSE
 : 
TRUE
);

107 
keyrow
=&
keym­
[(
sÿn_code
 & 0x7f)* 
MAP_COLS
];

108 
cŞumn
=0;

110 
ÿps
=
shiá_l
||
shiá_r
;

111 if(
ÿps_lock
)

113 if((
keyrow
[0] >= 'a') && (keyrow[0] <= 'z'))

115 
ÿps
=!caps;

118 if(
ÿps
)

120 
cŞumn
=1;

122 if(
code_w™h_E0
)

124 
cŞumn
=2;

125 
code_w™h_E0
=0;

127 
key
=
keyrow
[
cŞumn
];

129 
key
)

131 
SHIFT_L
:

132 
shiá_l
=
make
;

134 
SHIFT_R
:

135 
shiá_r
=
make
;

137 
CTRL_L
:

138 
ù¾_l
=
make
;

140 
CTRL_R
:

141 
ù¾_r
=
make
;

143 
ALT_L
:

144 
®t_l
=
make
;

146 
ALT_R
:

147 
®t_r
=
make
;

149 
CAPS_LOCK
:

150 if(
make
)

152 
ÿps_lock
 = !caps_lock;

153 
	`£t_Ëds
();

156 
NUM_LOCK
:

157 if(
make
)

159 
num_lock
=!num_lock;

160 
	`£t_Ëds
();

163 
SCROLL_LOCK
:

164 if(
make
)

166 
süŞl_lock
=!scroll_lock;

167 
	`£t_Ëds
();

173 if(
make
 == 1)

175 
·d
=0;

176 if((
key
>=
PAD_SLASH
è&& (key<=
PAD_9
))

178 
·d
=1;

179 
key
)

181 
PAD_SLASH
:

182 
key
='/';

184 
PAD_STAR
:

185 
key
='*';

187 
PAD_MINUS
:

188 
key
='-';

190 
PAD_PLUS
:

191 
key
='+';

193 
PAD_ENTER
:

194 
key
=
ENTER
;

197 if(
num_lock
 && (
key
>=
PAD_0
è&& (key<=
PAD_9
))

199 
key
=key-
PAD_0
+'0';

201 if(
num_lock
 && 
key
 =ğ
PAD_DOT
)

203 
key
='.';

207 
key
)

209 
PAD_HOME
:

210 
key
=
HOME
;

212 
PAD_END
:

213 
key
=
END
;

215 
PAD_PAGEUP
:

216 
key
=
PAGEUP
;

218 
PAD_PAGEDOWN
:

219 
key
=
PAGEDOWN
;

221 
PAD_INS
:

222 
key
=
INSERT
;

224 
PAD_UP
:

225 
key
=
UP
;

227 
PAD_DOWN
:

228 
key
=
DOWN
;

230 
PAD_LEFT
:

231 
key
=
LEFT
;

233 
PAD_RIGHT
:

234 
key
=
RIGHT
;

236 
PAD_DOT
:

237 
key
=
DELETE
;

246 
key
 |ğ
shiá_l
 ? 
FLAG_SHIFT_L
 :0;

247 
key
 |ğ
shiá_r
 ? 
FLAG_SHIFT_R
 :0;

248 
key
 |ğ
ù¾_l
 ? 
FLAG_CTRL_L
 :0;

249 
key
 |ğ
ù¾_r
 ? 
FLAG_CTRL_R
 :0;

250 
key
 |ğ
®t_l
 ? 
FLAG_ALT_L
 :0;

251 
key
 |ğ
®t_r
 ? 
FLAG_ALT_R
 :0;

252 
key
 |=
·d
 ? 
FLAG_PAD
 :0;

254 
	`š_´oûss
(
p_‰y
,
key
);

258 
	}
}

261 
u8
 
	$g‘_by‹_äom_kbuf
()

263 
u8
 
sÿn_code
;

264 
kb_š
.
couÁ
 <=0)

267 
	`di§bË_št
();

268 
sÿn_code
=*(
kb_š
.
p_
++);

269 if(
kb_š
.
p_
 =ğkb_š.
buf
+
KB_IN_BYTES
)

271 
kb_š
.
p_
=kb_š.
buf
;

273 
kb_š
.
couÁ
--;

274 
	`’abË_št
();

275  
sÿn_code
;

276 
	}
}

278 
	$kb_wa™
()

280 
u8
 
kb_¡©
;

283 
kb_¡©
 = 
	`š_by‹
(
KB_CMD
);

284 }
kb_¡©
&0x02);

285 
	}
}

287 
	$kb_ack
()

289 
u8
 
kb_»ad
;

292 
kb_»ad
=
	`š_by‹
(
KB_DATA
);

293 }
kb_»ad
!=
KB_ACK
);

294 
	}
}

296 
	$£t_Ëds
()

298 
u8
 
Ëds
=(
ÿps_lock
<<2)|(
num_lock
<<1è|
süŞl_lock
;

299 
	`kb_wa™
();

300 
	`out_by‹
(
KB_DATA
,
LED_CODE
);

301 
	`kb_ack
();

302 
	`kb_wa™
();

303 
	`out_by‹
(
KB_DATA
,
Ëds
);

304 
	`kb_ack
();

305 
	}
}

	@main.c

1 
	~"h—d.h
"

3 
	$k”Ãl_maš
()

5 
ticks
=0;

6 
	`di¥_¡r
("-----kernel_main begins ----\n");

7 
TASK
* 
p_sk
=
sk_bË
;

8 
PROCESS
* 
p_´oc
 = 
´oc_bË
;

9 
u8
 
´ivege
;

10 
u8
 
½l
;

11 
eæags
;

12 * 
p_sk_¡ack
=
sk_¡ack
+
STACK_SIZE_TOTAL
;

13 
u16
 
£ËùÜ_ldt
=
SELECTOR_LDT_FIRST
;

14 
´io
;

15 
i
;

16 
i
=0;i<
NR_TASKS
+
NR_PROCS
;i++)

18 if(
i
<
NR_TASKS
)

20 
p_sk
=
sk_bË
+
i
;

21 
´ivege
=
PRIVILEGE_TASK
;

22 
½l
=
RPL_TASK
;

23 
eæags
=0x1202;

24 
´io
=15;

28 
p_sk
=
u£r_´oc_bË
+(
i
-
NR_TASKS
);

29 
´ivege
=
PRIVILEGE_USER
;

30 
½l
=
RPL_USER
;

31 
eæags
=0x202;

32 
´io
=5;

34 
	`¡rıy
(
p_´oc
->
Çme
,
p_sk
->name);

35 
p_´oc
->
pid
=
i
;

36 
p_´oc
->
ldt_£l
=
£ËùÜ_ldt
;

37 
	`memıy
(&
p_´oc
->
s_ldts
[0],

38 &
gdt
[
SELECTOR_KERNEL_CS
>>3],

39 (
DESCRIPTOR
));

40 
p_´oc
->
s_ldts
[0].
©Œ1
=
DA_C
|
´ivege
<<5;

41 
	`memıy
(&
p_´oc
->
s_ldts
[1],

42 &
gdt
[
SELECTOR_KERNEL_DS
>>3],

43 (
DESCRIPTOR
));

44 
p_´oc
->
s_ldts
[1].
©Œ1
 =
DA_DRW
 |
´ivege
 <<5;

45 
p_´oc
->
s_»gs
.
cs
=(0 & 
SA_RPL_MASK
 & 
SA_TI_MASK
 )| 
SA_TIL
 | 
½l
;

46 
p_´oc
->
s_»gs
.
ds
=(8 & 
SA_RPL_MASK
 & 
SA_TI_MASK
 ) | 
SA_TIL
| 
½l
;

47 
p_´oc
->
s_»gs
.
es
=(8 & 
SA_RPL_MASK
 & 
SA_TI_MASK
 ) | 
SA_TIL
 |
½l
;

48 
p_´oc
->
s_»gs
.
fs
=(8 & 
SA_RPL_MASK
 & 
SA_TI_MASK
 ) | 
SA_TIL
 | 
½l
;

49 
p_´oc
->
s_»gs
.
ss
=(8 & 
SA_RPL_MASK
 & 
SA_TI_MASK
 ) | 
SA_TIL
 | 
½l
;

50 
p_´oc
->
s_»gs
.
gs
=(
SELECTOR_KERNEL_GS
 & 
SA_RPL_MASK
è| 
½l
;

51 
p_´oc
->
s_»gs
.
e
=(
u32
è
p_sk
->
š™Ÿl_e
;

52 
p_´oc
->
s_»gs
.
e¥
=(
u32
è
p_sk_¡ack
;

53 
p_´oc
->
s_»gs
.
eæags
=eflags;

55 
p_´oc
->
Ä_‰y
=0;

56 
p_´oc
->
æags
=0;

57 
p_´oc
->
p_msg
=0;

58 
p_´oc
->
»cväom
=
NO_TASK
;

59 
p_´oc
->
£ndto
=
NO_TASK
;

60 
p_´oc
->
has_št_msg
=0;

61 
p_´oc
->
q_£ndšg
=0;

62 
p_´oc
->
Ãxt_£ndšg
=0;

63 
p_´oc
->
´iÜ™y
=
´io
;

64 
p_sk_¡ack
-=
p_sk
->
¡acksize
;

65 
p_´oc
++;

66 
p_sk
++;

67 
£ËùÜ_ldt
+=1<<3;

70 
k_»’‹r
=0;

71 
p_´oc_»ady
 = 
´oc_bË
;

74 
´oc_bË
[2].
Ä_‰y
=0;

75 
´oc_bË
[3].
Ä_‰y
=0;

76 
´oc_bË
[4].
Ä_‰y
=0;

78 
	`š™_şock
();

79 
	`»¡¬t
();

84 
	}
}

87 
	$Te¡A
()

91 
	`´štf
("%d",
	`g‘_ticks
());

92 
	`´štf
("A");

93 
	`mli_d–ay
(1000);

95 
	}
}

97 
	$Te¡B
()

102 
	`mli_d–ay
(1000);

104 
	}
}

106 
	$Te¡C
()

111 
	`mli_d–ay
(1000);

113 
	}
}

115 
	$·nic
(cÚ¡ *
fmt
,...)

117 
i
;

118 
buf
[256];

119 
va_li¡
 
¬g
=(va_li¡)((*)&
fmt
+4);

120 
i
=
	`v¥rštf
(
buf
,
fmt
,
¬g
);

121 
	`´štf
("%ø·niø%s",
MAG_CH_PANIC
,
buf
);

122 
	}
}

124 
	$g‘_ticks
()

126 
MESSAGE
 
msg
;

127 
	`»£t_msg
(&
msg
);

128 
msg
.
ty³
=
GET_TICKS
;

129 
	`£nd_»cv
(
BOTH
,
TASK_SYS
,&
msg
);

130  
msg
.
RETVAL
;

131 
	}
}

	@misc.c

1 
	~"h—d.h
"

3 
	$¥š
(*
func_Çme
)

5 
	`´štf
("\n¥šnšg iÀ% ...\n",
func_Çme
);

8 
	}
}

10 
	$as£¹iÚ_çu»
(*
exp
,*
fe
,*
ba£_fe
,
lše
)

12 
	`´štf
("%ø‡s£¹(%sèçed: fe: %s, ba£_fe: %s, iÀ%d",
MAG_CH_ASSERT
,
exp
,
fe
,
ba£_fe
,
lše
);

13 
	`¥š
("assertion_failure()");

14 
__asm__
 
	`__vŞ©e__
("ud2");

15 
	}
}

	@printf.c

1 
	~"h—d.h
"

2 
	$´štf
(cÚ¡ *
fmt
, ...)

4 
i
;

5 
buf
[256];

6 
va_li¡
 
¬g
=(va_li¡)((* )(&
fmt
)+4);

7 
i
=
	`v¥rštf
(
buf
,
fmt
,
¬g
);

8 
buf
[
i
]=0;

9 
	`´štx
(
buf
);

10  
i
;

11 
	}
}

	@proc.c

1 
	~"h—d.h
"

2 
block
(
´oc
 *
p
);

3 
unblock
(
´oc
 *
p
);

4 
d—dlock
(
¤c
,
de¡
);

5 
msg_£nd
(
´oc
 *
cu¼’t
,
de¡
,
MESSAGE
 *
m
);

6 
msg_»ûive
(
´oc
 *
cu¼’t
,
¤c
,
MESSAGE
 *
m
);

7 
£nd»cv
(
funùiÚ
,
¤c_de¡
,
MESSAGE
 *
msg
);

9 
	$sys_g‘_ticks
()

11  
ticks
;

12 
	}
}

14 
	$scheduË
()

16 
PROCESS
* 
p
;

17 
g»©e¡_ticks
=0;

19 !
g»©e¡_ticks
)

21 
p
=
´oc_bË
;p<´oc_bË+
NR_TASKS
+
NR_PROCS
;p++)

23 if(
p
->
æags
==0)

25 if(
p
->
ticks
>
g»©e¡_ticks
)

27 
g»©e¡_ticks
=
p
->
ticks
;

28 
p_´oc_»ady
=
p
;

32 if(!
g»©e¡_ticks
)

34 
p
=
´oc_bË
;p<´oc_bË+
NR_TASKS
+
NR_PROCS
;p++)

35 if(
p
->
æags
==0)

36 
p
->
ticks
õ->
´iÜ™y
;

39 
	}
}

41 
	$sys_£nd»c
(
funùiÚ
,
¤c_de¡
,
MESSAGE
* 
m
,
´oc
*
p
)

43 
	`as£¹
(
k_»’‹r
==0);

44 
	`as£¹
((
¤c_de¡
 >ğ0 && src_de¡ < 
NR_TASKS
 + 
NR_PROCS
)

45 || 
¤c_de¡
 ==
ANY
 || src_de¡ =ğ
INTERRUPT
);

46 
»t
=0;

47 
ÿÎ”
=
	`´oc2pid
(
p
);

48 
MESSAGE
* 
mÏ
=(MESSAGE*)
	`va2Ï
(
ÿÎ”
,
m
);

49 
mÏ
->
sourû
=
ÿÎ”
;

50 
	`as£¹
(
mÏ
->
sourû
 !ğ
¤c_de¡
);

51 if(
funùiÚ
 =ğ
SEND
)

53 
»t
=
	`msg_£nd
(
p
,
¤c_de¡
,
m
);

54 if(
»t
 !=0)

55  
»t
;

57 if(
funùiÚ
 =ğ
RECEIVE
)

59 
»t
=
	`msg_»ûive
(
p
,
¤c_de¡
,
m
);

60 if(
»t
 !=0)

61  
»t
;

65 
	`´štf
("proc.c:65");

66 
	`·nic
("sys_sendrec invalid function: %d (SEND: %d, RECEIVE: %d).",

67 
funùiÚ
,
SEND
,
RECEIVE
);

70 
	}
}

72 *
	$va2Ï
(
pid
,*
va
)

74 
´oc
 *
p
=&
´oc_bË
[
pid
];

75 
u32
 
£g_ba£
=
	`ldt_£g_lš—r
(
p
,
INDEX_LDT_RW
);

76 
u32
 
Ï
=
£g_ba£
 +(u32)
va
;

77 if(
pid
<
NR_TASKS
+
NR_PROCS
)

79 
	`as£¹
(
Ï
==(
u32
)
va
);

81  (*)
Ï
;

82 
	}
}

84 
	$ldt_£g_lš—r
(
´oc
 *
p
,
idx
)

86 
desütÜ
 *
d
=&(
p
->
s_ldts
[
idx
]);

87  
d
->
ba£_high
<<24 | d->
ba£_mid
<<16 || d->
ba£_low
;

88 
	}
}

90 
	$»£t_msg
(
MESSAGE
 *
p
)

92 
	`mem£t
(
p
,0,(
MESSAGE
));

93 
	}
}

95 
	$block
(
´oc
 *
p
)

97 
	`as£¹
(
p
->
æags
);

98 
	`scheduË
();

99 
	}
}

101 
	$unblock
(
´oc
 *
p
)

103 
	`as£¹
(
p
->
æags
==0);

104 
	}
}

106 
	$d—dlock
(
¤c
,
de¡
)

108 
´oc
 *
p
=
´oc_bË
+
de¡
;

111 if(
p
->
æags
 & 
SENDING
)

113 if(
p
->
£ndto
 ==
¤c
)

115 
p
=
´oc_bË
+
de¡
;

116 
	`´štf
("=_=%s",
p
->
Çme
);

119 
	`as£¹
(
p
->
p_msg
);

120 
p
=
´oc_bË
+p->
£ndto
;

121 
	`´štf
("->%s",
p
->
Çme
);

122 }
p
!=
´oc_bË
+
¤c
);

123 
	`´štf
("=_=");

126 
p
=
´oc_bË
+p->
£ndto
;

134 
	}
}

137 
	$msg_£nd
(
´oc
 *
cu¼’t
,
de¡
,
MESSAGE
 *
m
)

139 
´oc
 *
£nd”
=
cu¼’t
;

140 
´oc
 *
p_de¡
=
´oc_bË
+
de¡
;

141 
	`as£¹
(
	`´oc2pid
(
£nd”
)!=
de¡
);

142 if(
	`d—dlock
(
	`´oc2pid
(
£nd”
),
de¡
))

144 
	`·nic
(">>DEADLOCK<< %s->%s",
£nd”
->
Çme
,
p_de¡
->name);

146 if((
p_de¡
->
æags
 & 
RECEIVING
) &&

147 (
p_de¡
->
»cväom
 =ğ
	`´oc2pid
(
£nd”
è||…_de¡->»cväom=ğ
ANY
))

149 
	`as£¹
(
p_de¡
->
p_msg
);

150 
	`as£¹
(
m
);

152 
	`phys_cİy
(
	`va2Ï
(
de¡
,
p_de¡
->
p_msg
),

153 
	`va2Ï
(
	`´oc2pid
(
£nd”
),
m
),

154 (
MESSAGE
));

155 
p_de¡
->
p_msg
=0;

156 
p_de¡
->
æags
&=~
RECEIVING
;

157 
p_de¡
->
»cväom
=
NO_TASK
;

158 
	`unblock
(
p_de¡
);

159 
	`as£¹
(
p_de¡
->
æags
 ==0);

160 
	`as£¹
(
p_de¡
->
p_msg
 ==0);

161 
	`as£¹
(
p_de¡
->
»cväom
==
NO_TASK
);

162 
	`as£¹
(
p_de¡
->
£ndto
 ==
NO_TASK
);

163 
	`as£¹
(
£nd”
->
æags
==0);

164 
	`as£¹
(
£nd”
->
p_msg
==0);

165 
	`as£¹
(
£nd”
->
»cväom
==
NO_TASK
);

166 
	`as£¹
(
£nd”
->
£ndto
==
NO_TASK
);

170 
£nd”
->
æags
 |ğ
SENDING
;

172 
£nd”
->
£ndto
=
de¡
;

173 
£nd”
->
p_msg
=
m
;

174 
´oc
 *
p
;

175 if(
p_de¡
->
q_£ndšg
)

177 
p
=
p_de¡
->
q_£ndšg
;

178 
p
->
Ãxt_£ndšg
)

180 
p
õ->
Ãxt_£ndšg
;

182 
p
->
Ãxt_£ndšg
=
£nd”
;

186 
p_de¡
->
q_£ndšg
=
£nd”
;

188 
£nd”
->
Ãxt_£ndšg
=0;

189 
	`block
(
£nd”
);

191 
	`as£¹
(
£nd”
->
æags
==
SENDING
);

192 
	`as£¹
(
£nd”
->
p_msg
!=0);

193 
	`as£¹
(
£nd”
->
»cväom
==
NO_TASK
);

194 
	`as£¹
(
£nd”
->
£ndto
==
de¡
);

197 
	}
}

199 
	$msg_»ûive
(
´oc
 *
cu¼’t
,
¤c
,
MESSAGE
 *
m
)

201 
´oc
 *
p_who_»cv
=
cu¼’t
;

202 
´oc
 *
p_äom
=0;

203 
´oc
 *
´ev
=0;

204 
cİyok
=0;

206 if((
p_who_»cv
->
has_št_msg
) &&

207 ((
¤c
==
ANY
è|| (¤ø==
INTERRUPT
)))

209 
MESSAGE
 
msg
;

210 
	`»£t_msg
(&
msg
);

211 
msg
.
sourû
=
INTERRUPT
;

212 
msg
.
ty³
=
HARD_INT
;

213 
	`phys_cİy
(
	`va2Ï
(
	`´oc2pid
(
p_who_»cv
),
m
),&
msg
,(
MESSAGE
));

214 
p_who_»cv
->
has_št_msg
=0;

215 
	`as£¹
(
m
);

216 
	`as£¹
(
p_who_»cv
->
æags
==0);

217 
	`as£¹
(
p_who_»cv
->
p_msg
==0);

218 
	`as£¹
(
p_who_»cv
->
£ndto
==
NO_TASK
);

219 
	`as£¹
(
p_who_»cv
->
has_št_msg
==0);

222 if(
¤c
==
ANY
)

224 if(
p_who_»cv
->
q_£ndšg
)

226 
p_äom
=
p_who_»cv
->
q_£ndšg
;

227 
cİyok
=1;

230 if(
¤c
>=0 &&

231 
¤c
< 
NR_TASKS
+
NR_PROCS
)

233 
p_äom
=&
´oc_bË
[
¤c
];

234 if((
p_äom
->
æags
 & 
SENDING
) &&

235 (
p_äom
->
£ndto
 =ğ
	`´oc2pid
(
p_who_»cv
)))

237 
cİyok
=1;

238 
´oc
 *
p
=
p_who_»cv
->
q_£ndšg
;

239 
	`as£¹
(
p
);

240 
p
)

242 if(
	`´oc2pid
(
p
è==
¤c
)

244 
´ev
=
p
;

245 
p
õ->
Ãxt_£ndšg
;

250 if(
cİyok
)

252 if(
p_äom
 ==
p_who_»cv
->
q_£ndšg
)

254 
p_who_»cv
->
q_£ndšg
=
p_äom
->
Ãxt_£ndšg
;

255 
p_äom
->
Ãxt_£ndšg
=0;

259 
´ev
->
Ãxt_£ndšg
=
p_äom
->next_sending;

260 
p_äom
->
Ãxt_£ndšg
=0;

263 
	`phys_cİy
(
	`va2Ï
(
	`´oc2pid
(
p_who_»cv
),
m
),

264 
	`va2Ï
(
	`´oc2pid
(
p_äom
),p_äom->
p_msg
),

265 (
MESSAGE
));

266 
p_äom
->
p_msg
=0;

267 
p_äom
->
£ndto
=
NO_TASK
;

268 
p_äom
->
æags
&=~
SENDING
;

269 
	`unblock
(
p_äom
);

274 
p_who_»cv
->
æags
|=
RECEIVING
;

275 
p_who_»cv
->
p_msg
=
m
;

276 
p_who_»cv
->
»cväom
=
¤c
;

277 
	`block
(
p_who_»cv
);

281 
	}
}

283 
	$£nd_»cv
(
funùiÚ
,
¤c_de¡
,
MESSAGE
 *
msg
)

285 
»t
=0;

286 if(
funùiÚ
==
RECEIVE
)

287 
	`mem£t
(
msg
,0,(
MESSAGE
));

288 
funùiÚ
)

290 
BOTH
:

291 
»t
=
	`£nd»c
(
SEND
,
¤c_de¡
,
msg
);

292 if(
»t
==0)

293 
»t
=
	`£nd»c
(
RECEIVE
,
¤c_de¡
,
msg
);

295 
SEND
:

296 
RECEIVE
:

297 
»t
 = 
	`£nd»c
(
funùiÚ
,
¤c_de¡
,
msg
);

300 
	`as£¹
((
funùiÚ
==
BOTH
) ||

301 (
funùiÚ
=ğ
SEND
) ||

302 (
funùiÚ
 =ğ
RECEIVE
));

305  
»t
;

306 
	}
}

	@protect.c

1 
	~"h—d.h
"

3 
š™_idt_desc
(
veùÜ
, 
u8
 
desc_ty³
,

4 
št_hªdËr
 
hªdËr
, 
´ivege
);

5 
š™_desütÜ
(
DESCRIPTOR
* 
p_desc
,
u32
 
ba£
 ,u32 
lim™
,
u16
 
©Œibu‹
);

8 
divide_”rÜ
();

9 
sšgË_¡•_exû±iÚ
();

10 
nmi
();

11 
b»akpošt_exû±iÚ
();

12 
ov”æow
();

13 
bounds_check
();

14 
šv®_İcode
();

15 
cİr_nÙ_avaabË
();

16 
doubË_çuÉ
();

17 
cİr_£g_ov”run
();

18 
šv®_tss
();

19 
£gm’t_nÙ_´e£Á
();

20 
¡ack_exû±iÚ
();

21 
g’”®_´ÙeùiÚ
();

22 
·ge_çuÉ
();

23 
cİr_”rÜ
();

24 
hwšt00
();

25 
hwšt01
();

26 
hwšt02
();

27 
hwšt03
();

28 
hwšt04
();

29 
hwšt05
();

30 
hwšt06
();

31 
hwšt07
();

32 
hwšt08
();

33 
hwšt09
();

34 
hwšt10
();

35 
hwšt11
();

36 
hwšt12
();

37 
hwšt13
();

38 
hwšt14
();

39 
hwšt15
();

41 
	$š™_´Ù
()

43 
	`š™_8259A
();

45 
	`š™_idt_desc
(
INT_VECTOR_SYS_CALL
,
DA_386IG©e
,

46 
sys_ÿÎ
,
PRIVILEGE_USER
);

49 
	`š™_idt_desc
(
INT_VECTOR_DIVIDE
, 
DA_386IG©e
,

50 
divide_”rÜ
, 
PRIVILEGE_KERNEL
);

52 
	`š™_idt_desc
(
INT_VECTOR_DEBUG
, 
DA_386IG©e
,

53 
sšgË_¡•_exû±iÚ
, 
PRIVILEGE_KERNEL
);

55 
	`š™_idt_desc
(
INT_VECTOR_NMI
, 
DA_386IG©e
,

56 
nmi
, 
PRIVILEGE_KERNEL
);

58 
	`š™_idt_desc
(
INT_VECTOR_BREAKPOINT
, 
DA_386IG©e
,

59 
b»akpošt_exû±iÚ
, 
PRIVILEGE_USER
);

61 
	`š™_idt_desc
(
INT_VECTOR_OVERFLOW
, 
DA_386IG©e
,

62 
ov”æow
, 
PRIVILEGE_USER
);

64 
	`š™_idt_desc
(
INT_VECTOR_BOUNDS
, 
DA_386IG©e
,

65 
bounds_check
, 
PRIVILEGE_KERNEL
);

67 
	`š™_idt_desc
(
INT_VECTOR_INVAL_OP
, 
DA_386IG©e
,

68 
šv®_İcode
, 
PRIVILEGE_KERNEL
);

70 
	`š™_idt_desc
(
INT_VECTOR_COPROC_NOT
, 
DA_386IG©e
,

71 
cİr_nÙ_avaabË
, 
PRIVILEGE_KERNEL
);

73 
	`š™_idt_desc
(
INT_VECTOR_DOUBLE_FAULT
, 
DA_386IG©e
,

74 
doubË_çuÉ
, 
PRIVILEGE_KERNEL
);

76 
	`š™_idt_desc
(
INT_VECTOR_COPROC_SEG
, 
DA_386IG©e
,

77 
cİr_£g_ov”run
, 
PRIVILEGE_KERNEL
);

79 
	`š™_idt_desc
(
INT_VECTOR_INVAL_TSS
, 
DA_386IG©e
,

80 
šv®_tss
, 
PRIVILEGE_KERNEL
);

82 
	`š™_idt_desc
(
INT_VECTOR_SEG_NOT
, 
DA_386IG©e
,

83 
£gm’t_nÙ_´e£Á
, 
PRIVILEGE_KERNEL
);

85 
	`š™_idt_desc
(
INT_VECTOR_STACK_FAULT
, 
DA_386IG©e
,

86 
¡ack_exû±iÚ
, 
PRIVILEGE_KERNEL
);

88 
	`š™_idt_desc
(
INT_VECTOR_PROTECTION
, 
DA_386IG©e
,

89 
g’”®_´ÙeùiÚ
, 
PRIVILEGE_KERNEL
);

91 
	`š™_idt_desc
(
INT_VECTOR_PAGE_FAULT
, 
DA_386IG©e
,

92 
·ge_çuÉ
, 
PRIVILEGE_KERNEL
);

94 
	`š™_idt_desc
(
INT_VECTOR_COPROC_ERR
, 
DA_386IG©e
,

95 
cİr_”rÜ
, 
PRIVILEGE_KERNEL
);

97 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 0, 
DA_386IG©e
,

98 
hwšt00
, 
PRIVILEGE_KERNEL
);

100 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 1, 
DA_386IG©e
,

101 
hwšt01
, 
PRIVILEGE_KERNEL
);

103 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 2, 
DA_386IG©e
,

104 
hwšt02
, 
PRIVILEGE_KERNEL
);

106 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 3, 
DA_386IG©e
,

107 
hwšt03
, 
PRIVILEGE_KERNEL
);

109 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 4, 
DA_386IG©e
,

110 
hwšt04
, 
PRIVILEGE_KERNEL
);

112 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 5, 
DA_386IG©e
,

113 
hwšt05
, 
PRIVILEGE_KERNEL
);

115 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 6, 
DA_386IG©e
,

116 
hwšt06
, 
PRIVILEGE_KERNEL
);

118 
	`š™_idt_desc
(
INT_VECTOR_IRQ0
 + 7, 
DA_386IG©e
,

119 
hwšt07
, 
PRIVILEGE_KERNEL
);

121 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 0, 
DA_386IG©e
,

122 
hwšt08
, 
PRIVILEGE_KERNEL
);

124 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 1, 
DA_386IG©e
,

125 
hwšt09
, 
PRIVILEGE_KERNEL
);

127 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 2, 
DA_386IG©e
,

128 
hwšt10
, 
PRIVILEGE_KERNEL
);

130 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 3, 
DA_386IG©e
,

131 
hwšt11
, 
PRIVILEGE_KERNEL
);

133 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 4, 
DA_386IG©e
,

134 
hwšt12
, 
PRIVILEGE_KERNEL
);

136 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 5, 
DA_386IG©e
,

137 
hwšt13
, 
PRIVILEGE_KERNEL
);

139 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 6, 
DA_386IG©e
,

140 
hwšt14
, 
PRIVILEGE_KERNEL
);

142 
	`š™_idt_desc
(
INT_VECTOR_IRQ8
 + 7, 
DA_386IG©e
,

143 
hwšt15
, 
PRIVILEGE_KERNEL
);

144 
i
;

145 
PROCESS
* 
p_´oc
=
´oc_bË
;

146 
u16
 
£ËùÜ_ldt
=
INDEX_LDT_FIRST
<<3;

147 
i
=0;i<
NR_TASKS
+
NR_PROCS
;i++)

149 
	`š™_desütÜ
(&
gdt
[
£ËùÜ_ldt
>>3],

150 
	`vœ2phys
(
	`£g2phys
(
SELECTOR_KERNEL_DS
),
´oc_bË
[
i
].
s_ldts
),

151 
LDT_SIZE
*(
DESCRIPTOR
)-1,
DA_LDT
);

152 
p_´oc
++;

153 
£ËùÜ_ldt
+=1<<3;

155 
	`mem£t
(&
tss
,0,(tss));

156 
tss
.
ss0
=
SELECTOR_KERNEL_DS
;

157 
	`š™_desütÜ
(&
gdt
[
INDEX_TSS
],

158 
	`vœ2phys
(
	`£g2phys
(
SELECTOR_KERNEL_DS
),&
tss
),

159 (
tss
)-1,
DA_386TSS
);

160 
tss
.
ioba£
=(tss);

162 
	}
}

165 
u32
 
	$£g2phys
(
u16
 
£g
)

167 
DESCRIPTOR
* 
p_de¡
=&
gdt
[
£g
 >> 3];

168  (
p_de¡
->
ba£_high
 << 24 |…_de¡->
ba£_mid
 <<16 |…_de¡->
ba£_low
);

170 
	}
}

172 
	$š™_idt_desc
(
veùÜ
, 
u8
 
desc_ty³
,

173 
št_hªdËr
 
hªdËr
, 
´ivege
)

175 
GATE
 * 
p_g©e
 = &
idt
[
veùÜ
];

176 
u32
 
ba£
 = (u32)
hªdËr
;

177 
p_g©e
->
off£t_low
 = 
ba£
 & 0xFFFF;

178 
p_g©e
->
£ËùÜ
 = 
SELECTOR_KERNEL_CS
;

179 
p_g©e
->
dcouÁ
 = 0;

180 
p_g©e
->
©Œ
 = 
desc_ty³
 | (
´ivege
 << 5);

181 
p_g©e
->
off£t_high
 = (
ba£
 >> 16) & 0xFFFF;

182 
	}
}

184 
	$š™_desütÜ
(
DESCRIPTOR
* 
p_desc
,
u32
 
ba£
,u32 
lim™
,
u16
 
©Œibu‹
)

186 
p_desc
->
lim™_low
=
lim™
&0x0ffff;

187 
p_desc
->
ba£_low
=
ba£
 & 0x0ffff;

188 
p_desc
->
ba£_mid
=(
ba£
>>16) & 0xff;

189 
p_desc
->
©Œ1
 =
©Œibu‹
 & 0xff;

190 
p_desc
->
lim™_high_©Œ2
=((
lim™
>>16è& 0xfè|((
©Œibu‹
 >>8) & 0xf0);

191 
p_desc
->
ba£_high
=(
ba£
>>24) & 0xff;

192 
	}
}

194 
	$exû±iÚ_hªdËr
(
vec_no
,
”r_code
,
e
,
cs
,
eæags
)

196 
i
;

197 
‹xt_cŞÜ
 = 0x74;

199 * 
”r_msg
[] = {"#DE Divide Error",

222 
di¥_pos
 = 0;

223 
i
=0;i<80*5;i++){

224 
	`di¥_¡r
(" ");

226 
di¥_pos
 = 0;

228 
	`di¥_cŞÜ_¡r
("Exû±iÚ! --> ", 
‹xt_cŞÜ
);

229 
	`di¥_cŞÜ_¡r
(
”r_msg
[
vec_no
], 
‹xt_cŞÜ
);

230 
	`di¥_cŞÜ_¡r
("\n\n", 
‹xt_cŞÜ
);

231 
	`di¥_cŞÜ_¡r
("EFLAGS:", 
‹xt_cŞÜ
);

232 
	`di¥_št
(
eæags
);

233 
	`di¥_cŞÜ_¡r
("CS:", 
‹xt_cŞÜ
);

234 
	`di¥_št
(
cs
);

235 
	`di¥_cŞÜ_¡r
("EIP:", 
‹xt_cŞÜ
);

236 
	`di¥_št
(
e
);

238 if(
”r_code
 != 0xFFFFFFFF){

239 
	`di¥_cŞÜ_¡r
("E¼Ü code:", 
‹xt_cŞÜ
);

240 
	`di¥_št
(
”r_code
);

242 
	}
}

	@start.c

1 
	~"h—d.h
"

3 
	$c¡¬t
()

5 
	`di¥_¡r
("\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n------cstart------\n");

6 
	`memıy
(&
gdt
,(*)(*((
u32
*)(&
gdt_±r
[2]))),*((
u16
*)(&gdt_ptr[0]))+1);

7 
u16
* 
p_gdt_lim™
=(u16*)(&
gdt_±r
[0]);

8 
u32
* 
p_gdt_ba£
 = (u32*)(&
gdt_±r
[2]);

9 *
p_gdt_lim™
 = 
GDT_SIZE
 * (
DESCRIPTOR
) -1;

10 *
p_gdt_ba£
 = (
u32
è&
gdt
;

12 
u16
* 
p_idt_lim™
=(u16*)(&
idt_±r
[0]);

13 
u32
* 
p_idt_ba£
=(u32*)(&
idt_±r
[2]);

14 *
p_idt_lim™
 = 
IDT_SIZE
 *(
GATE
) -1;

15 *
p_idt_ba£
ğ(
u32
)&
idt
;

17 
	`š™_´Ù
();

19 
	`di¥_¡r
("-------cstartƒnds------\n");

20 
	}
}

	@syscall.S

1 
	~"scÚ¡.h
"

3 .
£t
 
	g_NR_´štx
,0

4 .
£t
 
	g_NR_£nd»c
,1

5 .
£t
 
	gINT_VECTOR_SYS_CALL
,0x90

7 .
glob®
 
	g´štx
,
£nd»c


9 
	g´štx
:

10 
mov
 
$_NR_´štx
,%
—x


11 
	gmov
 4(%
	ge¥
),%
edx


12 
$INT_VECTOR_SYS_CALL


13 
»t


15 
	g£nd»c
:

16 
mov
 
$_NR_£nd»c
,%
—x


17 
	gmov
 4(%
	ge¥
),%
ebx


18 
	gmov
 8(%
	ge¥
),%
ecx


19 
	gmov
 12(%
	ge¥
),%
edx


20 
$INT_VECTOR_SYS_CALL


21 
	g»t


	@systask.c

1 
	~"h—d.h
"

3 
	$sk_sys
()

5 
MESSAGE
 
msg
;

8 
	`£nd_»cv
(
RECEIVE
,
ANY
,&
msg
);

9 
¤c
=
msg
.
sourû
;

10 
msg
.
ty³
)

12 
GET_TICKS
:

13 
msg
.
RETVAL
=
ticks
;

14 
	`£nd_»cv
(
SEND
,
¤c
,&
msg
);

17 
	`·nic
("unknown msgype");

21 
	}
}

	@tty.c

1 
	~"h—d.h
"

2 
	~"keybßrd.h
"

4 
š™_‰y
(
TTY
* 
p_‰y
);

5 
‰y_do_»ad
(
TTY
* 
p_‰y
);

6 
‰y_do_wr™e
(
TTY
* 
p_‰y
);

7 
put_key
(
TTY
* 
‰y
,
u32
 
key
);

9 
	$sk_‰y
()

11 
TTY
* 
p_‰y
;

12 
	`š™_keybßrd
();

14 
p_‰y
=
‰y_bË
;p_‰y<‰y_bË+
NR_CONSOLES
;p_tty++)

16 
	`š™_‰y
(
p_‰y
);

18 
	`£Ëù_cÚsŞe
(0);

21 
p_‰y
=
‰y_bË
;p_‰y<‰y_bË+
NR_CONSOLES
;p_tty++)

23 
	`‰y_do_»ad
(
p_‰y
);

24 
	`‰y_do_wr™e
(
p_‰y
);

27 
	}
}

29 
	$š™_‰y
(
TTY
* 
p_‰y
)

31 
p_‰y
->
šbuf_couÁ
=0;

32 
p_‰y
->
p_šbuf_h—d
õ_‰y->
p_šbuf_
õ_‰y->
š_buf
;

33 
	`š™_sü“n
(
p_‰y
);

34 
	}
}

36 
	$‰y_do_»ad
(
TTY
* 
p_‰y
)

38 if(
	`is_cu¼’t_cÚsŞe
(
p_‰y
->
p_cÚsŞe
))

40 
	`keybßrd_»ad
(
p_‰y
);

42 
	}
}

44 
	$‰y_do_wr™e
(
TTY
* 
p_‰y
)

46 if(
p_‰y
->
šbuf_couÁ
>0)

48 
ch
=*(
p_‰y
->
p_šbuf_
++);

49 if(
p_‰y
->
p_šbuf_
 =ğp_‰y->
š_buf
+
TTY_IN_BYTES
)

51 
p_‰y
->
p_šbuf_
õ_‰y->
š_buf
;

53 
p_‰y
->
šbuf_couÁ
--;

54 
	`out_ch¬
(
p_‰y
->
p_cÚsŞe
,
ch
);

56 
	}
}

58 
	$‰y_wr™e
(
TTY
* 
p_‰y
,* 
buf
,
Ën
)

60 * 
p
=
buf
;

61 
i
=
Ën
;

62 
i
)

64 
	`out_ch¬
(
p_‰y
->
p_cÚsŞe
,*
p
++);

65 
i
--;

67 
	}
}

69 
	$sys_wr™e
(* 
buf
,
Ën
,
PROCESS
* 
p_´oc
)

71 
	`‰y_wr™e
(&
‰y_bË
[
p_´oc
->
Ä_‰y
],
buf
,
Ën
);

73 
	}
}

74 
	$put_key
(
TTY
* 
p_‰y
,
u32
 
key
)

76 if(
p_‰y
->
šbuf_couÁ
<
TTY_IN_BYTES
)

78 *(
p_‰y
->
p_šbuf_h—d
++)=
key
;

79 if(
p_‰y
->
p_šbuf_h—d
=õ_‰y->
š_buf
+
TTY_IN_BYTES
)

81 
p_‰y
->
p_šbuf_h—d
õ_‰y->
š_buf
;

83 
p_‰y
->
šbuf_couÁ
++;

85 
	}
}

87 
	$š_´oûss
(
TTY
* 
p_‰y
,
u32
 
key
)

89 if(!(
key
 & 
FLAG_EXT
))

91 
	`put_key
(
p_‰y
,
key
);

95 
¿w_code
=
key
& 
MASK_RAW
;

96 
¿w_code
)

98 
ENTER
:

99 
	`put_key
(
p_‰y
,'\n');

101 
BACKSPACE
:

102 
	`put_key
(
p_‰y
,'\b');

104 
UP
:

105 if((
key
 & 
FLAG_SHIFT_L
è|| (key& 
FLAG_SHIFT_R
))

107 
	`süŞl_sü“n
(
p_‰y
->
p_cÚsŞe
,
SCR_UP
);

110 
DOWN
:

111 if((
key
 & 
FLAG_SHIFT_L
è|| (key& 
FLAG_SHIFT_R
))

113 
	`süŞl_sü“n
(
p_‰y
->
p_cÚsŞe
,
SCR_DN
);

116 
F1
:

117 
F2
:

118 
F3
:

119 
F4
:

120 
F5
:

121 
F6
:

122 
F7
:

123 if((
key
 & 
FLAG_ALT_L
è|| (key & 
FLAG_ALT_R
))

125 
	`£Ëù_cÚsŞe
(
¿w_code
-
F1
);

130 
	}
}

132 
	$sys_´štx
(
_unsued1
,
_unu£d2
,*
s
,
´oc
 *
p_´oc
)

134 cÚ¡ *
p
;

135 
ch
;

136 
»’‹r_”r
[]=" k_reenter is incorrrect for unknown„eason";

137 
»’‹r_”r
[0]=
MAG_CH_PANIC
;

139 if(
k_»’‹r
==0)

140 
p
=
	`va2Ï
(
	`´oc2pid
(
p_´oc
),
s
);

141 if(
k_»’‹r
>0)

142 
p
=
s
;

144 
p
=
»’‹r_”r
;

146 if((*
p
==
MAG_CH_PANIC
) ||

147 (*
p
==
MAG_CH_ASSERT
 && 
p_´oc_»ady
<&
´oc_bË
[
NR_TASKS
]))

149 
	`di§bË_št
();

150 *
v
=(*)
V_MEM_BASE
;

151 cÚ¡ * 
q
=
p
+1;

152 
v
<(*)(
V_MEM_BASE
+
V_MEM_SIZE
))

154 *
v
++=*
q
++;

155 *
v
++=
RED_CHAR
;

156 if(!*
q
)

158 (()
v
-
V_MEM_BASE
è+(
SCREEN_WIDTH
*16))

160 
v
++;

161 *
v
++=
GRAY_CHAR
;

163 
q
=
p
+1;

166 
__asm__
 
	`__vŞ©e__
("hlt");

168 (
ch
=*
p
++)!=0)

170 if(
ch
=ğ
MAG_CH_PANIC
 || ch=ğ
MAG_CH_ASSERT
)

174 
	`out_ch¬
(
‰y_bË
[
p_´oc
->
Ä_‰y
].
p_cÚsŞe
,
ch
);

177 
	}
}

	@vsprintf.c

1 
	~"ty³.h
"

2 
	~"cÚ¡.h
"

3 
	~"¡ršg.h
"

5 *
	$i2a
(
v®
,
ba£
,**
ps
)

7 
m
=
v®
 %
ba£
;

8 
q
=
v®
/
ba£
;

9 if(
q
)

11 
	`i2a
(
q
,
ba£
,
ps
);

13 *(*
ps
)++=(
m
<10)? (m+'0'): (m-10+'A');

14  *
ps
;

15 
	}
}

18 
	$v¥rštf
(* 
buf
,cÚ¡ * 
fmt
,
va_li¡
 
¬gs
)

20 * 
p
;

21 
va_li¡
 
p_Ãxt_¬g
=
¬gs
;

22 
m
;

23 
šÃr_buf
[
STR_DEFAULT_LEN
];

24 
cs
;

25 
®ign_Ä
;

26 
p
=
buf
;*
fmt
;fmt++)

28 if(*
fmt
 != '%')

30 *
p
++=*
fmt
;

35 
®ign_Ä
=0;

37 
fmt
++;

38 if(*
fmt
 =='%')

40 *
p
++=*
fmt
;

43 if(*
fmt
=='0')

45 
cs
='0';

46 
fmt
++;

50 
cs
=' ';

52 (()(*
fmt
)>='0') &&

53 (()(*
fmt
)<='9'))

55 
®ign_Ä
*=10;

56 
®ign_Ä
+=*
fmt
-'0';

57 
fmt
++;

59 *
q
=
šÃr_buf
;

60 
	`mem£t
(
q
,0,(
šÃr_buf
));

62 *
fmt
)

65 *
q
++=*((*)
p_Ãxt_¬g
);

66 
p_Ãxt_¬g
+=4;

69 
m
=*((*)
p_Ãxt_¬g
);

70 
	`i2a
(
m
,16,&
q
);

71 
p_Ãxt_¬g
+=4;

74 
m
=*((*)
p_Ãxt_¬g
);

75 if(
m
<0)

77 
m
=m*(-1);

78 *
q
++='-';

80 
	`i2a
(
m
,10,&
q
);

81 
p_Ãxt_¬g
+=4;

84 
	`¡rıy
(
q
,(*((**)
p_Ãxt_¬g
)));

85 
q
+=
	`¡¾’
(*((**)
p_Ãxt_¬g
));

86 
p_Ãxt_¬g
+=4;

91 
k
;

92 
k
=0;k<((
®ign_Ä
 >
	`¡¾’
(
šÃr_buf
))?

93 (
®ign_Ä
-
	`¡¾’
(
šÃr_buf
)): 0);
k
++)

95 *
p
++=
cs
;

97 
q
=
šÃr_buf
;

98 *
q
)

100 *
p
++=*
q
++;

103 *
p
=0;

104  (
p
-
buf
);

105 
	}
}

	@/usr/include/string.h

24 #iâdef 
_STRING_H


25 
	#_STRING_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


32 
	#__Ãed_size_t


	)

33 
	#__Ãed_NULL


	)

34 
	~<¡ddef.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

38 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 
__BEGIN_NAMESPACE_STD


44 *
	$memıy
 (*
__»¡riù
 
__de¡
,

45 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

46 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

49 *
	$memmove
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
)

50 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

51 
__END_NAMESPACE_STD


56 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


57 *
	$memcıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

58 
__c
, 
size_t
 
__n
)

59 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

63 
__BEGIN_NAMESPACE_STD


65 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

68 
	$memcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

72 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


75 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

76 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 
__cÚ¡
 *
	`memchr
 (__cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

78 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

80 #ifdeà
__OPTIMIZE__


81 
__ex‹º_®ways_šlše
 *

82 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


84  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

87 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

88 
	`memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


90  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

93 
	}
}

95 *
	$memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

96 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

98 
__END_NAMESPACE_STD


100 #ifdeà
__USE_GNU


103 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


104 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

105 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

106 "C++" 
__cÚ¡
 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

107 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

109 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

110 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


115 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

116 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

117 "C++" 
__cÚ¡
 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

120 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

126 
__BEGIN_NAMESPACE_STD


128 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

129 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

131 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

132 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

133 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

137 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

139 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

140 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡rcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

146 
	$¡ºcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

147 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

150 
	$¡rcŞl
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

153 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

154 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

155 
__THROW
 
	`__nÚnuÎ
 ((2));

156 
__END_NAMESPACE_STD


158 #ifdeà
__USE_XOPEN2K8


162 
	~<xloÿË.h
>

165 
	$¡rcŞl_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

166 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

168 
size_t
 
	$¡rxäm_l
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

169 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

172 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

173 || 
defšed
 
__USE_XOPEN2K8


175 *
	$¡rdup
 (
__cÚ¡
 *
__s
)

176 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

182 #ià
defšed
 
__USE_XOPEN2K8


183 *
	$¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

184 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

187 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


189 
	#¡rdu·
(
s
) \

190 (
__ex‹nsiÚ__
 \

192 
__cÚ¡
 *
__Şd
 = (
s
); \

193 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

194 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

195 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

196 
	}
}))

	)

199 
	#¡ºdu·
(
s
, 
n
) \

200 (
__ex‹nsiÚ__
 \

202 
__cÚ¡
 *
__Şd
 = (
s
); \

203 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

204 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

205 
__Ãw
[
__Ën
] = '\0'; \

206 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

207 }))

	)

210 
	g__BEGIN_NAMESPACE_STD


212 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


215 *
¡rchr
 (*
__s
, 
__c
)

216 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

217 
__cÚ¡
 *
¡rchr
 (__cÚ¡ *
__s
, 
__c
)

218 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

220 #ifdeà
__OPTIMIZE__


221 
__ex‹º_®ways_šlše
 *

222 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


224  
__butš_¡rchr
 (
__s
, 
__c
);

227 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

228 
¡rchr
 (
__cÚ¡
 *
__s
, 
__c
è
	g__THROW


230  
__butš_¡rchr
 (
__s
, 
__c
);

235 *
	$¡rchr
 (
__cÚ¡
 *
__s
, 
__c
)

236 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

239 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


242 *
	`¡¼chr
 (*
__s
, 
__c
)

243 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

244 
__cÚ¡
 *
	`¡¼chr
 (__cÚ¡ *
__s
, 
__c
)

245 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

247 #ifdeà
__OPTIMIZE__


248 
__ex‹º_®ways_šlše
 *

249 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


251  
	`__butš_¡¼chr
 (
__s
, 
__c
);

254 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

255 
	`¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


257  
	`__butš_¡¼chr
 (
__s
, 
__c
);

260 
	}
}

262 *
	$¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
)

263 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

265 
__END_NAMESPACE_STD


267 #ifdeà
__USE_GNU


270 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


271 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

272 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

273 "C++" 
__cÚ¡
 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

274 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

276 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

277 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

281 
__BEGIN_NAMESPACE_STD


284 
size_t
 
	$¡rc¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__»jeù
)

285 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

288 
size_t
 
	$¡r¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

289 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

291 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


294 *
	`¡½brk
 (*
__s
, 
__cÚ¡
 *
__acû±
)

295 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

296 
__cÚ¡
 *
	`¡½brk
 (__cÚ¡ *
__s
, __cÚ¡ *
__acû±
)

297 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

299 #ifdeà
__OPTIMIZE__


300 
__ex‹º_®ways_šlše
 *

301 
	`¡½brk
 (*
__s
, 
__cÚ¡
 *
__acû±
è
__THROW


303  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

306 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

307 
	`¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
è
__THROW


309  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

312 
	}
}

314 *
	$¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

318 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


321 *
	`¡r¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
)

322 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

323 
__cÚ¡
 *
	`¡r¡r
 (__cÚ¡ *
__hay¡ack
,

324 
__cÚ¡
 *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

335 
	`¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 
__cÚ¡
 *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" 
__cÚ¡
 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
,

370 
__cÚ¡
 *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (
__cÚ¡
 *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 
__cÚ¡
 *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (
__cÚ¡
 *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2));

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 
__cÚ¡
 *
	`šdex
 (__cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

482 
	`šdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (
__cÚ¡
 *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 
__cÚ¡
 *
	`ršdex
 (__cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

510 
	`ršdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (
__cÚ¡
 *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 #ifdeà
__GNUC__


530 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

531 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

536 
	$¡rÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

537 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

540 
	$¡ºÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

541 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

544 #ifdef 
__USE_GNU


547 
	$¡rÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

548 
__loÿË_t
 
__loc
)

549 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

551 
	$¡ºÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

552 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

553 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

556 #ifdef 
__USE_BSD


559 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

560 
__cÚ¡
 *
__»¡riù
 
__d–im
)

561 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

564 #ifdef 
__USE_XOPEN2K8


566 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

569 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

577 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

578 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

579 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

580 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

581 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 #ifdef 
__USE_GNU


586 
	$¡rv”scmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

587 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

590 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

595 #iâdeà
ba£Çme


600 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


601 "C++" *
	$ba£Çme
 (*
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

603 "C++" 
__cÚ¡
 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
)

604 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

606 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

612 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

613 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

614 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


634 
	~<b™s/¡ršg.h
>

637 
	~<b™s/¡ršg2.h
>

640 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


642 
	~<b™s/¡ršg3.h
>

646 
__END_DECLS


	@/usr/include/features.h

20 #iâdef 
_FEATURES_H


21 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC99


98 #undeà
__USE_ISOC95


99 #undeà
__USE_POSIX


100 #undeà
__USE_POSIX2


101 #undeà
__USE_POSIX199309


102 #undeà
__USE_POSIX199506


103 #undeà
__USE_XOPEN


104 #undeà
__USE_XOPEN_EXTENDED


105 #undeà
__USE_UNIX98


106 #undeà
__USE_XOPEN2K


107 #undeà
__USE_XOPEN2KXSI


108 #undeà
__USE_XOPEN2K8


109 #undeà
__USE_XOPEN2K8XSI


110 #undeà
__USE_LARGEFILE


111 #undeà
__USE_LARGEFILE64


112 #undeà
__USE_FILE_OFFSET64


113 #undeà
__USE_BSD


114 #undeà
__USE_SVID


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__FAVOR_BSD


121 #undeà
__KERNEL_STRICT_NAMES


125 #iâdeà
_LOOSE_KERNEL_NAMES


126 
	#__KERNEL_STRICT_NAMES


	)

130 
	#__USE_ANSI
 1

	)

139 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


140 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

141 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

143 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

148 #ià
defšed
 
_BSD_SOURCE
 && \

149 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

150 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

151 
	#__FAVOR_BSD
 1

	)

155 #ifdeà
_GNU_SOURCE


156 #undeà
_ISOC95_SOURCE


157 
	#_ISOC95_SOURCE
 1

	)

158 #undeà
_ISOC99_SOURCE


159 
	#_ISOC99_SOURCE
 1

	)

160 #undeà
_POSIX_SOURCE


161 
	#_POSIX_SOURCE
 1

	)

162 #undeà
_POSIX_C_SOURCE


163 
	#_POSIX_C_SOURCE
 200809L

	)

164 #undeà
_XOPEN_SOURCE


165 
	#_XOPEN_SOURCE
 700

	)

166 #undeà
_XOPEN_SOURCE_EXTENDED


167 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

168 #undeà
_LARGEFILE64_SOURCE


169 
	#_LARGEFILE64_SOURCE
 1

	)

170 #undeà
_BSD_SOURCE


171 
	#_BSD_SOURCE
 1

	)

172 #undeà
_SVID_SOURCE


173 
	#_SVID_SOURCE
 1

	)

174 #undeà
_ATFILE_SOURCE


175 
	#_ATFILE_SOURCE
 1

	)

180 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

181 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

182 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

183 
	#_BSD_SOURCE
 1

	)

184 
	#_SVID_SOURCE
 1

	)

191 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

192 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

193 
	#__USE_ISOC99
 1

	)

197 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

198 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

199 
	#__USE_ISOC95
 1

	)

204 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

205 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

206 
	#_POSIX_SOURCE
 1

	)

207 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

208 
	#_POSIX_C_SOURCE
 2

	)

209 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

210 
	#_POSIX_C_SOURCE
 199506L

	)

211 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

212 
	#_POSIX_C_SOURCE
 200112L

	)

214 
	#_POSIX_C_SOURCE
 200809L

	)

216 
	#__USE_POSIX_IMPLICITLY
 1

	)

219 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


220 
	#__USE_POSIX
 1

	)

223 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


224 
	#__USE_POSIX2
 1

	)

227 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

228 
	#__USE_POSIX199309
 1

	)

231 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

232 
	#__USE_POSIX199506
 1

	)

235 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

236 
	#__USE_XOPEN2K
 1

	)

237 #undeà
__USE_ISOC95


238 
	#__USE_ISOC95
 1

	)

239 #undeà
__USE_ISOC99


240 
	#__USE_ISOC99
 1

	)

243 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

244 
	#__USE_XOPEN2K8
 1

	)

245 #undeà
_ATFILE_SOURCE


246 
	#_ATFILE_SOURCE
 1

	)

249 #ifdef 
_XOPEN_SOURCE


250 
	#__USE_XOPEN
 1

	)

251 #ià(
_XOPEN_SOURCE
 - 0) >= 500

252 
	#__USE_XOPEN_EXTENDED
 1

	)

253 
	#__USE_UNIX98
 1

	)

254 #undeà
_LARGEFILE_SOURCE


255 
	#_LARGEFILE_SOURCE
 1

	)

256 #ià(
_XOPEN_SOURCE
 - 0) >= 600

257 #ià(
_XOPEN_SOURCE
 - 0) >= 700

258 
	#__USE_XOPEN2K8
 1

	)

259 
	#__USE_XOPEN2K8XSI
 1

	)

261 
	#__USE_XOPEN2K
 1

	)

262 
	#__USE_XOPEN2KXSI
 1

	)

263 #undeà
__USE_ISOC95


264 
	#__USE_ISOC95
 1

	)

265 #undeà
__USE_ISOC99


266 
	#__USE_ISOC99
 1

	)

269 #ifdeà
_XOPEN_SOURCE_EXTENDED


270 
	#__USE_XOPEN_EXTENDED
 1

	)

275 #ifdeà
_LARGEFILE_SOURCE


276 
	#__USE_LARGEFILE
 1

	)

279 #ifdeà
_LARGEFILE64_SOURCE


280 
	#__USE_LARGEFILE64
 1

	)

283 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

284 
	#__USE_FILE_OFFSET64
 1

	)

287 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


288 
	#__USE_MISC
 1

	)

291 #ifdef 
_BSD_SOURCE


292 
	#__USE_BSD
 1

	)

295 #ifdef 
_SVID_SOURCE


296 
	#__USE_SVID
 1

	)

299 #ifdef 
_ATFILE_SOURCE


300 
	#__USE_ATFILE
 1

	)

303 #ifdef 
_GNU_SOURCE


304 
	#__USE_GNU
 1

	)

307 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


308 
	#__USE_REENTRANT
 1

	)

311 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

312 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

313 #ià
_FORTIFY_SOURCE
 > 1

314 
	#__USE_FORTIFY_LEVEL
 2

	)

316 
	#__USE_FORTIFY_LEVEL
 1

	)

319 
	#__USE_FORTIFY_LEVEL
 0

	)

323 
	~<b™s/´edefs.h
>

326 
	#__STDC_ISO_10646__
 200009L

	)

334 #undeà
__GNU_LIBRARY__


335 
	#__GNU_LIBRARY__
 6

	)

339 
	#__GLIBC__
 2

	)

340 
	#__GLIBC_MINOR__
 13

	)

342 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

343 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

346 #ià
defšed
 
__GNUC__
 \

347 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

348 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

349 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

350 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

354 #iâdeà
__ASSEMBLER__


355 #iâdeà
_SYS_CDEFS_H


356 
	~<sys/cdefs.h
>

361 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


362 
	#__USE_LARGEFILE
 1

	)

363 
	#__USE_LARGEFILE64
 1

	)

369 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

370 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

371 && 
defšed
 
	g__ex‹º_šlše


372 
	#__USE_EXTERN_INLINES
 1

	)

377 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

378 && (
defšed
 
	g_LIBC
 || !defšed 
	g__OPTIMIZE_SIZE__
è&& !defšed 
	g__NO_INLINE__
 \

379 && 
defšed
 
	g__ex‹º_šlše


380 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

388 
	~<gnu/¡ubs.h
>

	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
__loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

43 
__loÿË_t
 
	tloÿË_t
;

	@
1
.
1
/usr/include
19
209
clock.c
console.c
global.c
i8259.c
kernel.S
keyboard.c
main.c
misc.c
printf.c
proc.c
protect.c
start.c
syscall.S
systask.c
tty.c
vsprintf.c
/usr/include/string.h
/usr/include/features.h
/usr/include/xlocale.h
